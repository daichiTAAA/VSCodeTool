# サンプルプロジェクト構想

<br>

# 文書情報

---

* **文書名**: サンプルプロジェクト構想（完全版・改訂版）
* **作成日**: 2025年9月6日
* **更新日**: 2025年9月7日
* **バージョン**: 2.2
* **作成者**: システム開発チーム

---

# 1. 目的

オンプレミスのシステムを主な対象としつつ、**VS Code と Databricks を連携**させ、

* コーディング／ドキュメント作成
* 運用／企画／要件定義
* アプリケーション開発

といった業務において、**会話エージェントを通じてナレッジ参照・根拠付きレビュー・データ活用**を実現する。
Databricks は「ジョブ/ワークフロー運用基盤」ではなく、**ナレッジベース／AIエージェント／データ取得・分析ハブ**として活用する。

---

# 2. なぜ VS Code と Databricks を組み合わせる必要があるのか

従来の問題：

* コードレビュー・ドキュメントレビューが「経験や勘」に依存し、**根拠提示に時間**
* オンプレ環境のアプリや運用スクリプトは**個別最適化され、横展開できない**
* 企画や要件定義の段階で**社内の過去資産やベストプラクティスを探すのが困難**
* データ分析や定量根拠の提示が**現場と分断**され、判断が遅れる

VS Code 単体では「今の編集中の文脈」は取れるが、「組織知」までは参照できない。
Databricks 単体では「ナレッジやデータ分析」は強いが、\*\*開発者の手元文脈（差分・デバッグ・選択範囲）」に即応できない。

➡️ 両者をつなぐことで、\*\*「手元の作業と組織知を一気通貫で結びつける」\*\*ことが可能になる。
これにより：

* コーディング/ドキュメントでの根拠付きレビュー
* 運用/要件定義での既存資産再利用
* アプリ開発の設計段階でのベストプラクティス検索
* 企画段階でのデータに基づく意思決定支援

といった従来難しかった価値が生まれる。

---

# 3. VS Code

## 3.1 強み

* **IDE統合**: 編集・差分・SCM・デバッグ・タスクを API で制御
* **AI連携**: Copilot Agent Mode ＋ LM Tool API による会話からの即時操作
* **ドキュメント支援**: Notebook API、Language API による構造化レビュー
* **セキュリティ**: SecretStorage、Workspace Trust
* **デバッグ/検証**: Debug/Terminal API によるローカルアプリやオンプレシステムの動作検証

---

# 4. Databricks（本プロジェクトにおける位置づけ）

* **ナレッジベース**

  * 規程、標準、過去の設計書、ドキュメント、良質な実装例を Vector Search に格納し、検索可能にする
* **AIエージェント基盤**

  * AgentBricks / Serving Endpoints を利用して、自然言語から知識や分析を返す
* **データ取得・分析ハブ**

  * オンプレのログやメトリクスを収集し、SQL Warehouse／Notebookで定量分析
  * 企画・要件定義・運用判断の根拠を VS Code / WebUI に返す

---

# 5. ユースケース（オンプレ/業務全般対応）

## 5.1 コーディング／ドキュメントレビュー

* **問題**: レビューが主観的で時間がかかる
* **解決**: Vector Search から規程や過去資産を引用 → VS Code コメントに根拠提示
* **効果**: 引用付きレビュー、一次レビュー短縮

## 5.2 運用スクリプト／アプリの検証

* **問題**: オンプレ環境での動作確認が属人的
* **解決**: VS Code デバッグ/ターミナルから直接検証 → Databricks Serving Endpointで結果を比較
* **効果**: 再現性向上、MTTR短縮

## 5.3 企画・要件定義支援

* **問題**: 過去事例や数値根拠を探せず、要件が抽象的になりがち
* **解決**: Databricks Vector Search/SQL Warehouseから過去案件・定量分析を取得し、VS Code 内で引用提示
* **効果**: 要件定義の精度↑、企画時点で根拠ある議論が可能

## 5.4 変更影響分析

* **問題**: オンプレシステムの修正が下流プロセスにどう影響するか把握困難
* **解決**: Unity Catalog / Lineageでデータ流れを参照 → IDEで影響を可視化
* **効果**: 影響漏れ防止、手戻り削減

## 5.5 Runbook支援

* **問題**: インシデント対応が属人化し時間がかかる
* **解決**: Databricks エージェントがログやメトリクスを集約 → IDE/専用WebUIで引用付き初動案を提示
* **効果**: MTTR短縮、属人化防止

## 5.6 再利用促進（ドキュメント・設計書）

* **問題**: 既存の要件定義書・設計書を見つけられず、ゼロから作り直す
* **解決**: Vector Search APIで類似案件のドキュメントを検索 → Quick Fixで参照リンク提示
* **効果**: 再利用率↑、企画/設計工数削減

---

# 6. WebUI vs VS Code Agentモードの使い分け

| 観点     | 専用WebUI                              | VS Code Agentモード                              |
| -------- | -------------------------------------- | ------------------------------------------------ |
| 主対象   | 現場担当・企画・監査                   | 開発者・設計者・運用エンジニア                   |
| 文脈     | 業務フロー、承認UI、一覧               | 差分、選択範囲、デバッグ、ターミナル             |
| 監査性   | 操作ログ、承認フロー、SSO/MFA          | IDE操作、監査はGatewayで補完                     |
| 配布     | ブラウザ即利用                         | 拡張導入が必要                                   |
| 実行制御 | 本番環境のデータアクセス、承認必須操作 | ローカル検証・PR前チェック・ドキュメント作成支援 |

---

# 7. アーキテクチャ全体像

```
[ユーザー]
 ├ WebUI（企画・監査・現場向け）
 └ VS Code Agent Mode（開発/設計/運用）

[共通エージェント/サービス層]
 ├ Databricks Serving Endpoints（知識検索・分析・要約）
 ├ AgentBricks（会話型エージェント）
 ├ Vector Search（規程/設計書/過去案件検索）
 ├ Unity Catalog（データ分類・リネージ）
 └ SQL Warehouse/Notebook（定量分析）

[Gateway/ガバナンス]
 ├ 認証・認可（SSO, SCIM, IP制御）
 ├ 監査ログ（誰が/何を/いつ）
 └ ポリシー/レート制御
```

---

# 8. MVP段階

* **MVP-1**: ドキュメントレビュー（引用提示）
* **MVP-2**: コードレビュー（規約・例外・ログ規定）
* **MVP-3**: 要件定義支援（過去事例引用、数値根拠提示）
* **MVP-4**: 運用スクリプト検証（Debug/Terminal＋Serving結果照合）
* **MVP-5**: インシデントRunbook支援（ログ集約と引用付き初動案）

---

# 9. 効果指標（KPI例）

* 引用付き指摘率: +40%以上
* 一次レビュー時間: −30〜50%
* 再利用率（要件定義/設計書/コード）: +25〜40%
* 高リスク変更見逃し率: −60%
* MTTR: −20〜35%
* 企画/要件定義の精度: +20〜30%

---

# 10. リスクと対策

* **誤答リスク**: Agentは Human-in-the-loop 運用必須
* **監査抜け**: WebUI/Gatewayで補完
* **二重実装リスク**: エージェント/サービス層を共通化
* **導入負荷**: VS Code Agent PoCから開始→成果確認後にWebUI展開

---

# 11. 導入ロードマップ

1. **共通バックエンド（Serving/AgentBricks/Gateway）構築**
2. **VS Code Agent拡張PoC**（レビュー＋要件定義支援）
3. **WebUI展開**（企画・監査・運用向け）
4. **全社展開**（開発～運用～企画のナレッジ駆動型業務へ）

---

✅ **総括**
本構想は「オンプレシステム主体の開発・運用・企画業務」において、

* **VS Code** が「手元文脈での即時レビュー・検証・作成」を担い、
* **Databricks** が「ナレッジベース／AIエージェント／データ分析ハブ」として根拠を提供し、
* **WebUI** が「企画・監査・現場の統制窓口」として機能する。

これにより、\*\*今まで難しかった“根拠付きレビュー・再利用・要件定義の定量化・属人化した初動の標準化”\*\*が可能になる。
