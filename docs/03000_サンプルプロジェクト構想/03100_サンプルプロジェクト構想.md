# サンプルプロジェクト構想

<br>

# 文書情報
---
* **文書名**: サンプルプロジェクト構想
* **作成日**: 2025年9月6日
* **更新日**: 2025年9月6日
* **バージョン**: 1.0
* **作成者**: システム開発チーム

<br>

# 1. 目的
DatabricksとVS Codeを連携し活用するサンプルプロジェクトを通じて必要な機能を検証し、実務への適用可能性を評価する。

# 2. VS Code × Databricks が活きるケース（Agent Mode + Language Model Tool API 前提）

本節は、VS Code 単体・Databricks 単体ではなく、VS Code の GitHub Copilot Agent モードと Language Model Tool API（LM Tools）で“連携”させることで生まれる強みと適用ケースを整理する。

## 2.1 シナジーの核（なぜ組み合わせると強いか）
- 文脈×一次情報: VS CodeのIDE文脈（編集中の内容・選択範囲・diff・言語種別）に、Databricksの一次情報（SQL結果、Unity Catalogの分類/リネージ、Vector Searchの社内規程/実例）を重ね、質問やレビューを“その場”で根拠付きにする。
- Agentによる自動ツール選択: Copilot Agentが会話の流れで必要なLMツールを自動起動し、ユーザー操作を減らす（例: 差分→規程検索→引用提示）。
- 引用一貫性: LMツールが返す結果に出典を含め、Copilotが要約に引用を維持。説得力と再現性が担保される。
- ガバナンス適合: VS Code側は最小データ（選択範囲/差分）のみ送信、Databricks側はGateway越しのread-only参照・監査・レート制御で統制。
- 再利用の可視化: Databricks上の保存済みクエリ/ダッシュボード/良質サンプルをIDEに直接引き上げ、重複実装を削減。

## 2.2 相乗効果が高いユースケース（VS Code側×Databricks側×得られる価値）
- 引用付きドキュメントレビュー
  - VS Code: 編集中文書の構造/差分を把握
  - Databricks: Vector Searchで規程/ベストプラクティス/実例を探索
  - 相乗効果: 1ターンで“指摘＋根拠リンク”を提示、手戻り削減
- 変更差分の要点サマリ
  - VS Code: Git差分・コミット文脈
  - Databricks: 関連規程/影響領域（用語/テーブル/API）を検索
  - 相乗効果: レビュー観点を自動抽出し重要箇所に集中
- コード/SQL規約レビュー
  - VS Code: 言語種別/構文/静的情報
  - Databricks: 標準クエリ・規約のナレッジ
  - 相乗効果: “修正方針＋参照”で合意形成が早い
- データ参照のコンプライアンスチェック
  - VS Code: コードからテーブル/列参照を抽出
  - Databricks: Unity Catalogで分類/リネージ照会
  - 相乗効果: PIIや機密データの扱いを“その場で”注意喚起
- 変更影響分析（Impact Analysis）
  - VS Code: 変更対象の識別（ファイル/関数/クエリ）
  - Databricks: 下流ノートブック/BI/ジョブのリネージ
  - 相乗効果: レビュー前に影響範囲を俯瞰し抜け漏れ防止
- 保存済みクエリ/ダッシュボード再利用
  - VS Code: 目的・差分背景の文脈
  - Databricks: 近傍の既存資産検索（Queries/Dashboards）
  - 相乗効果: 再発明回避、標準化促進
- Runbook支援とインシデント初動
  - VS Code: 作業中のファイル/ログ断片
  - Databricks: 運用ログ集計とRunbook文書
  - 相乗効果: 根拠付き初動手順を即時提示
- モデル/特徴量レジストリ探索
  - VS Code: 推論/学習コードの文脈
  - Databricks: Model Registry/Feature Storeのメタ情報
  - 相乗効果: 既存資産の再利用と仕様逸脱の早期発見
- レポート/設計書ドラフト生成
  - VS Code: 章立て/テンプレ
  - Databricks: SQL結果/統計の一次情報
  - 相乗効果: 引用付きの“たたき台”を素早く提示

## 2.3 効果の測定軸（シナジー起点）
- IDE外遷移回数の削減率（往復コストの削減）
- 引用付き指摘の割合（根拠の一貫性）
- 一次レビュー所要時間/PRあたり指摘収束までの反復回数
- 既存資産（Queries/Dashboards/サンプル）の再利用率

## 2.4 適用前提と運用上の前提
- 組織で Copilot Agent Mode と LM Tools の利用を許可（ポリシーで拡張の使用可）
- DatabricksへのアクセスはGateway経由のread-only・監査ありで提供
- 規程/Wiki/良質例の文書はVector Searchに、メタデータはUnity Catalogで参照可能

## 2.5 VS Code API × Databricks で効く統合点（抜粋）
- Language Model Tool API × Agent Mode: 会話に沿った自動ツール起動で“手が止まらない”
- SCM/Git × リネージ: 差分起点の影響分析と引用提示が自然に繋がる
- Editor/Diagnostics/Code Actions × Vector/SQL: その場で指摘表示と修正提案、根拠はDatabricks出典
- Comments/TreeView/Webview × 出典プレビュー: 指摘一覧と出典の横見せで判断が早い
- Notebook API × SQL/Model: セル粒度での検証・可視化とドキュメント化が並走

# 3. サンプルプロジェクト案（推奨）: ドキュメント/コード レビューエージェント

- ねらい
  - IDE内で編集中のドキュメント/コードを、組織知（規程・標準・ベストプラクティス・メタデータ）に基づいて“引用付き”でレビュー可能にする。

- 想定ユーザー/シナリオ
  - 開発者のセルフレビュー（PR前のMarkdown/コード/SQL）
  - レビューワーの根拠付きレビュー作成支援（変更差分の要点抽出）
  - テックライター/アーキテクトのテンプレ準拠・用語統一チェック

- 要件（機能・概要）
  - FR-01: アクティブドキュメント/選択範囲/変更差分をレビュー対象として受け付ける
  - FR-02: 指摘ごとに少なくとも1つの引用（規程/実例/メタデータ）を提示する
  - FR-03: ドキュメント観点（テンプレ準拠、必須章、用語統一、曖昧表現検知）
  - FR-04: コード観点（命名、例外、ログ、SQL規約、セキュリティ）
  - FR-05: データ参照がある場合、データ分類（PII等）・リネージに基づく注意点を提示
  - FR-06: レビュー厳格度（標準/緩め）切替、IDE内での箇条書き＋引用リンク提示

- 要件（非機能・概要）
  - NFR-01: 標準レビューで平均5秒以内の応答
  - NFR-02: IDE外への送信は最小化（選択範囲/差分/メタ情報）
  - NFR-03: 通信の暗号化と監査ログ（誰が/何を/いつ）
  - NFR-04: 組織ポリシーで拡張の利用可否を集中管理

- 全体設計（コンセプト）
  - VS Code（Copilot Agent Mode）: 会話IF＋IDEコンテキスト
  - レビュー拡張: 対象収集、問い合わせ生成、結果整形
  - Gateway（社内API）: 認証/監査/レート制御/ルーティング（read-only）
  - Databricks 知識基盤: Vector Search（規程/Wiki/良質例）、SQL Warehouse（メタ/品質指標）、Unity Catalog（分類/リネージ）

- スコープ/非スコープ
  - スコープ: Markdown/設計書、Python/SQL のレビュー、引用提示、ガバナンス運用
  - 非スコープ: 自動修正のコミット/プッシュ、データの書き込み操作、IDE外クライアント

- MVP段階と評価指標
  - MVP-1: ドキュメントレビュー（テンプレ準拠/用語統一/抜け漏れ）＋引用
  - MVP-2: コードレビュー（命名/例外/ログ/SQL規約）＋参考実装提示
  - MVP-3: データ使用チェック（分類/リネージに基づく注意点）
  - 指標: IDE外遷移回数の削減、一次レビュー時間、引用付き指摘の採用率
